% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/03_estimate_regularity.R
\name{estimate_locreg}
\alias{estimate_locreg}
\title{Local Regularity Parameters Estimation}
\usage{
estimate_locreg(
  data,
  idcol = "id_curve",
  tcol = "tobs",
  ycol = "X",
  t = 1/2,
  Delta = NULL,
  h = NULL,
  kernel_name = "epanechnikov",
  center = TRUE
)
}
\arguments{
\item{data}{A \code{data.table} (or \code{data.frame}), a \code{list} of \code{data.table} (or \code{data.frame}), or a \code{list} of \code{list}.
\itemize{
\item{If \code{data.table}:}{
It should contain the raw curve observations in at least three columns.
\itemize{
\item{\code{idcol} :}{ The name of the column containing the curve index in the sample.
Each curve index is repeated according to the number of observation points.}
\item{\code{tcol} :}{ The name of the column with observation points associated with each curve index.}
\item{\code{ycol} :}{ The name of the column with observed values at each observation point for each curve index.}
}
}
\item{If \code{list} of \code{data.table}:}{
In this case, each element in the \code{list} represents the observation data of a curve in the form of a \code{data.table} or \code{data.frame}.
Each \code{data.table} contains at least two columns.
\itemize{
\item{\code{tcol} :}{ The name of the column with observation points for the curve.}
\item{\code{ycol} :}{ The name of the column with observed values for the curve.}
}
}
\item{If \code{list} of \code{list}:}{
In this case, \code{data} is a list where each element is the observation data of a curve, given as a \code{list} of two vectors.
\itemize{
\item{\code{tcol} :}{ The vector containing observation points for the curve.}
\item{\code{ycol} :}{ The vector containing observed values for the curve.}
}
}
}}

\item{idcol}{\code{character}. If \code{data} is given as a \code{data.table} or \code{data.frame}, this is the name of the column that holds the curve index.
Each curve index is repeated according to the number of observation points. If \code{data} is a \code{list} of \code{data.table} (or \code{data.frame}) or a \code{list} of \code{list}, set \code{idcol = NULL}.}

\item{tcol}{\code{character}. The name of the column (or vector) containing the observation points for the curves.}

\item{ycol}{\code{character}. The name of the column with observed values for the curves.}

\item{t}{\code{vector (numeric)}. Observation points at which to estimate the local regularity parameters of the underlying process.}

\item{Delta}{\code{numeric (positive)}. The length of the neighborhood around each point in \code{t} for local regularity estimation.
Default is \code{Delta = NULL}, in which case it will be estimated from the data.}

\item{h}{\code{numeric (positive vector or scalar)}. Bandwidth parameter for the Nadaraya-Watson estimator used in local regularity estimation.
Default is \code{h = NULL}, allowing it to be determined by cross-validation on a subset of curves.
If \code{h} is a scalar, the same bandwidth is applied across all curves. If it is a vector, it must match the number of curves in \code{data}, with each element corresponding to a curve.}

\item{kernel_name}{\code{string}. Specifies the kernel function for estimation; default is "epanechnikov".
Supported kernels include: "epanechnikov", "biweight", "triweight", "tricube", "triangular", and "uniform".}

\item{center}{\code{logical}. If \code{TRUE}, centers the curves before regularity estimation.}
}
\value{
A \code{data.table} with columns:
\itemize{
\item{\code{t} :}{ The observation points around which local regularity is estimated.}
\item{\code{locreg_bw} :}{ The presmoothing bandwidth used for estimation.}
\item{\code{Delta} :}{ The neighborhood length around each \code{t} used in local regularity estimation.}
\item{\code{Nused} :}{ The number of curves contributing non-degenerate estimates around each \code{t}.}
\item{\code{Ht} :}{ Local exponent estimates, denoted by \eqn{H_t}.}
\item{\code{Lt} :}{ HÃ¶lder constant estimates, corresponding to \eqn{L_t^2}.}
}
}
\description{
This function estimates the local regularity parameters \eqn{H_t} and \eqn{L_t^2} defined in Section 3 of \insertCite{maissoro2024adaptive;textual}{adaptiveFTS}.
}
\examples{
\dontrun{
 # Load data
 data("data_far")

 # Define observation points for local regularity estimation
 t0 <- seq(0.2, 0.8, length.out = 8)

 # Estimate local regularity parameters
 dt_locreg <- estimate_locreg(data = data_far,
                              idcol = "id_curve",
                              tcol = "tobs",
                              ycol = "X",
                              t = t0,
                              Delta = NULL,
                              h = NULL,
                              kernel_name = "epanechnikov",
                              center = TRUE)

 dt_locreg
}

}
\references{
\insertAllCited{}
}
\seealso{
\code{\link[=estimate_nw]{estimate_nw()}}, \code{\link[=estimate_nw_bw]{estimate_nw_bw()}}, \code{\link[=simulate_far]{simulate_far()}}, etc.
}
