% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/07_estimate_constants.R
\name{estimate_empirical_mom}
\alias{estimate_empirical_mom}
\title{Estimate empirical \eqn{p}-th order moment of \eqn{X(t)}.}
\usage{
estimate_empirical_mom(
  data,
  idcol = NULL,
  tcol = "tobs",
  ycol = "X",
  t = c(1/4, 1/2, 3/4),
  mom_order = 1,
  h = NULL,
  center = TRUE,
  kernel_name = "epanechnikov"
)
}
\arguments{
\item{data}{A \code{data.table} (or \code{data.frame}), a \code{list} of \code{data.table} (or \code{data.frame}), or a \code{list} of \code{list}.
\itemize{
\item{If \code{data.table}:}{
It should contain the raw curve observations in at least three columns.
\itemize{
\item{\code{idcol} :}{ The name of the column containing the curve index in the sample.
Each curve index is repeated according to the number of observation points.}
\item{\code{tcol} :}{ The name of the column with observation points associated with each curve index.}
\item{\code{ycol} :}{ The name of the column with observed values at each observation point for each curve index.}
}
}
\item{If \code{list} of \code{data.table}:}{
In this case, each element in the \code{list} represents the observation data of a curve in the form of a \code{data.table} or \code{data.frame}.
Each \code{data.table} contains at least two columns.
\itemize{
\item{\code{tcol} :}{ The name of the column with observation points for the curve.}
\item{\code{ycol} :}{ The name of the column with observed values for the curve.}
}
}
\item{If \code{list} of \code{list}:}{
In this case, \code{data} is a list where each element is the observation data of a curve, given as a \code{list} of two vectors.
\itemize{
\item{\code{tcol} :}{ The vector containing observation points for the curve.}
\item{\code{ycol} :}{ The vector containing observed values for the curve.}
}
}
}}

\item{idcol}{\code{character}. If \code{data} is given as a \code{data.table} or \code{data.frame}, this is the name of the column that holds the curve index.
Each curve index is repeated according to the number of observation points. If \code{data} is a \code{list} of \code{data.table} (or \code{data.frame}) or a \code{list} of \code{list}, set \code{idcol = NULL}.}

\item{tcol}{\code{character}. The name of the column (or vector) containing the observation points for the curves.}

\item{ycol}{\code{character}. The name of the column with observed values for the curves.}

\item{t}{\code{vector (numeric)}. Observation points at which the \eqn{p}-th order moment of \eqn{X(t)} is estimated.
Each element should be a value between 0 and 1.}

\item{mom_order}{\code{numeric (positive scalar)}. The order of the moment to be computed (e.g., 1 for mean, 2 for variance).}

\item{h}{\code{numeric (positive vector or scalar)}. The smoothing bandwidth parameter.
Default \code{h = NULL}, in which case the bandwidth will be estimated by Cross-Validation on a subset of curves.
If \code{h} is a scalar, then all curves will be smoothed with the same bandwidth.
If \code{h} is a vector, its length must equal the number of curves in \code{data}, with each element corresponding
to a curve in the same order as in \code{data}.}

\item{center}{\code{logical}. If \code{TRUE}, then the \eqn{p}-th order moment of the centered \eqn{X(t)} is estimated.
Default is \code{TRUE}.}

\item{kernel_name}{\code{string}. Specifies the kernel function for estimation; default is "epanechnikov".
Supported kernels include: "epanechnikov", "biweight", "triweight", "tricube", "triangular", and "uniform".}
}
\value{
A \code{data.table} with three columns: \code{t}, \code{mom_order}, and \code{mom_estimate} corresponding to
the estimated \eqn{p}-th order moment of \eqn{X(t)} at each time point specified in \code{t}.
}
\description{
This function estimates the \eqn{p}-th order moment of \eqn{X(t)}, used in the empirical study section
of the papers \insertCite{maissoro2024adaptive;textual}{adaptiveFTS} and \insertCite{maissoro2024pred;textual}{adaptiveFTS}.
}
\examples{
\dontrun{
# Load example data
data("data_far")  # Replace with actual data containing observed curves

# Define parameters
observation_points <- c(0.25, 0.5, 0.75)  # Points at which to estimate moments
moment_order <- 2                         # Example: 2nd order moment (variance)
bandwidth <- 0.1                          # Smoothing parameter; can be NULL for CV-estimated

# Estimate the 2nd order moment (variance) at specified observation points
moment_estimates <- estimate_empirical_mom(
  data = data_far,
  t = observation_points,
  mom_order = moment_order,
  h = NULL,
  center = TRUE,
  kernel_name = "epanechnikov"
)

# View the result
print(moment_estimates)
}

}
\references{
\insertAllCited{}
}
\seealso{
\code{\link[=get_nw_optimal_bw]{get_nw_optimal_bw()}}, \code{\link[=estimate_empirical_mom_cpp]{estimate_empirical_mom_cpp()}}.
}
